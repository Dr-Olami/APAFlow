# Cerbos Schema Definitions for SMEFlow Multi-tenant RBAC
---
apiVersion: api.cerbos.dev/v1
schemaDefinition:
  description: |-
    Common schema definitions for SMEFlow multi-tenant resources and principals
  schemas:
    principal:
      type: object
      properties:
        id:
          type: string
          description: "User ID from Keycloak"
        tenant_id:
          type: string
          description: "Tenant identifier for multi-tenant isolation"
        roles:
          type: array
          items:
            type: string
          description: "User roles within the tenant"
        subscription_tier:
          type: string
          enum: ["free", "basic", "premium", "enterprise"]
          description: "Tenant subscription level"
        region:
          type: string
          description: "African region for localization"
      required: ["id", "tenant_id", "roles"]

    resource:
      type: object
      properties:
        id:
          type: string
          description: "Resource identifier"
        tenant_id:
          type: string
          description: "Tenant that owns this resource"
        owner_id:
          type: string
          description: "User who created/owns the resource"
        resource_type:
          type: string
          enum: ["agent", "workflow", "integration", "template", "data", "audit"]
          description: "Type of SMEFlow resource"
        visibility:
          type: string
          enum: ["private", "tenant", "public"]
          default: "tenant"
          description: "Resource visibility scope"
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required: ["id", "tenant_id", "resource_type"]