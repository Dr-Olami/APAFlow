FROM flowiseai/flowise:latest

# Create both log directories with proper permissions
USER root
RUN mkdir -p /root/.flowise/logs && \
    mkdir -p /usr/local/lib/node_modules/flowise/logs && \
    chmod -R 755 /root/.flowise && \
    chmod -R 755 /usr/local/lib/node_modules/flowise/logs

# Switch back to the default user
USER node

# Expose port
EXPOSE 3000

# Start Flowise
CMD ["npx", "flowise", "start"]
